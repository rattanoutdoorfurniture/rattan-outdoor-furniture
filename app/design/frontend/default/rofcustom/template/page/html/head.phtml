
<!-- Basic Page Needs
================================================== -->
<meta http-equiv="Content-Type" content="<?php echo $this->getContentType() ?>" />
<title><?php echo $this->getTitle() ?></title>
<meta name="description" content="<?php echo htmlspecialchars($this->getDescription()) ?>" />
<meta name="keywords" content="<?php echo htmlspecialchars($this->getKeywords()) ?>" />
<meta name="robots" content="<?php echo htmlspecialchars($this->getRobots()) ?>" />
<meta name="author" content="">
<meta name="google-site-verification" content="FZDC31mGIrSoBbOqM8oSp6RrVMZA5IgzITFazM8x3xE" />

<!-- Facebook Open Graph Metas
================================================== -->
    <!-- Facebook global meta  -->
    <meta property="og:site_name" content="<?php echo $this->__("Rattan Outdoor Furniture"); ?>"/>
<?php if (Mage::registry('current_product')) : ?>
    <!-- Facebook product meta -->
    <meta property="og:title" content="<?php echo Mage::registry('current_product')->getShortDescription()." ".Mage::registry('current_product')->getName() ." by Rattan Outdoor Furniture" ?>" />
    <meta property="og:description" content="<?php echo strip_tags(Mage::registry('current_product')->getMetaDescription()); ?>" />
    <meta property="og:image" content="<?php echo Mage::helper('catalog/image')->init(Mage::registry('current_product'), 'image')->resize(200,200);?>" />
    <meta property="og:url" content="<?php echo Mage::registry('current_product')->getProductUrl(); ?>" />
<?php else: ?>
    <!-- Facebook general meta -->
    <meta property="og:title" content="<?php echo $this->getTitle(); ?>" />
    <meta property="og:url" content="<?php echo $this->getUrl(); ?>" />
    <meta property="og:image" content="<?php echo str_replace("-left-","-centered-",$this->getLayout()->getBlock('header')->getLogoSrc()); ?>" />
    <meta property="og:description" content="<?php echo $this->getDescription(); ?>" />

<?php endif; ?>

<!-- Mobile Specific Metas
================================================== -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- Favicons
================================================== -->
<link rel="icon" href="<?php echo $this->getFaviconFile(); ?>" type="image/x-icon" />
<?php if($this->getFaviconFile()): ?>
<link rel="shortcut icon" href="<?php echo $this->getFaviconFile(); ?>" type="image/x-icon" />
<?php else: ?>
<link rel="shortcut icon" href="/skin/frontend/default/rofcustom/images/favicon.ico">
<?php endif; ?>
<link rel="apple-touch-icon" href="/skin/frontend/default/rofcustom/images/apple/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="/skin/frontend/default/rofcustom/images/apple/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="/skin/frontend/default/rofcustom/images/apple/apple-touch-icon-114x114.png">


<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<?php echo $this->getCssJsHtml() ?>
<?php echo $this->getChildHtml() ?>
<?php echo $this->helper('core/js')->getTranslatorScript() ?>
<?php echo $this->getIncludes() ?>



<script type="text/javascript">

    function getUrlParams(key) {
        var Params = {};
        var params = decodeURIComponent(location.search.slice(1)).split("&");
        for(i=0;i<params.length;i++){
            keyval=params[i].split("=");
            Params[keyval[0]]=keyval[1];
        }
        return typeof(key)==typeof(undefined) ? Params : ( typeof(Params[key])==typeof(undefined) ? Params : Params[key] );
    }

    /*
    function nextCheckoutStepUrl(step) {
        params = getUrlParams();
        params.step = (typeof(step)==typeof(undefined)) ? params.step+1 : step;
        newParams = jQuery.param(params);
        base = location.href.slice(0,location.href.indexOf('?'));
        return base + "?" + newParams;
    }

    function nextCheckoutStep(step) {
        step = typeof(step)==typeof(undefined) ? getUrlParams('step') : step;
        $("#checkout-box").removeClass('step'+(step)).addClass('step'+(++step));
        history.pushState(null, "Step " + step, (location.href.slice(0,-1)+step));
    }
    */

    jQuery(document).ready(function($){
        if($(".product-tab").length) {
            if($(location.hash).length) {
                $(".product-tab.active").removeClass("active");
                $(location.hash).addClass("active");
            }
        }
        $(".product-tab-title a").on("click", function(ev){
            ev.preventDefault();
            $("#product-tabs").find(".product-tab.active").removeClass("active");
            $(this.hash).addClass("active");
            scrollTop = $(document).scrollTop();
            location.hash = this.hash;
            $(document).scrollTop(scrollTop);
        });
        //$(".checkout-step-next-step").on("click", function(e) {
        //    e.preventDefault();
        //    if(this.id=="checkout-step3-submit-order") {
        //        formdata = $("#checkout-box-form").serializeArray();
        //        htmldata = $("<div/>");
        //        $(formdata).each(function(){
        //            row = $("<div/>");
        //            row.append(
        //                    $("<strong/>").text(this.name)
        //                ).append(
        //                    $("<span/>").text(this.value)
        //                );
        //            htmldata.append(row);
        //        });
        //        $("#checkout-box-step-4").append(htmldata);
        //    }
        //    nextCheckoutStep();
        //});
        if(location.pathname.match(/^\/$/)) {
            if(jQuery(".home-slide").length>=3) {
                jQuery.homeSlider = function() {
                    jQuery.homeSlider.slide = function() {
                        this.deferred   = jQuery.Deferred();
                        var $_def_current   = jQuery.Deferred();
                        var $_def_next      = jQuery.Deferred();
                        var $_slides        = jQuery('.home-slide');
                        var $_slide_current = $_slides.filter(".current");
                        var $_slide_next    = $_slides.filter(".next");
                        var $_new_next      = $_slide_next.next();
                            $_new_next      = !!$_new_next.length ? $_new_next : $_slides.first();
                        var $_slide_prev    = $_slides.filter(".prev");
                        $_slide_current.fadeOut(
                            "slow",
                            function() {
                                jQuery(this).
                                    addClass("prev").
                                    removeClass("current");
                                $_def_current.resolve();
                            }
                        );
                        $_slide_next.fadeIn(
                            "slow",
                            function(){
                                jQuery(this).
                                    addClass("current").
                                    removeClass("next");
                                $_def_next.resolve();
                            }
                        );
                        $_slide_prev.removeClass("prev");
                        $_new_next.addClass("next").removeClass("prev current");
                        jQuery.when($_def_current, $_def_next).done(this.deferred.resolve);

                    };
                    jQuery.homeSlider.deferred  = null;
                    jQuery.homeSlider.timeout   = 5000;
                    jQuery.homeSlider.stop      = function() {
                        clearTimeout(jQuery.homeSlider.To);
                    };
                    jQuery.homeSlider.ToFunc    = function() {
                        jQuery.homeSlider.slide();
                        jQuery.when(jQuery.homeSlider.deferred).done(function() {
                            clearTimeout(jQuery.homeSlider.To);
                            jQuery.homeSlider.To = setTimeout(jQuery.homeSlider.ToFunc,jQuery.homeSlider.timeout);
                        });
                    };
                    jQuery.homeSlider.To = setTimeout(jQuery.homeSlider.ToFunc,jQuery.homeSlider.timeout);
                };
                jQuery.homeSlider();
            }
        }
        if(location.href.match(/products/)) {
            jQuery(".product-details-options-color-swatch").bind("click", function(e) {
                var $this       = jQuery(this);
                $this.siblings(".selected").removeClass("selected");
                var selection   = $this.data('color');
                var parent      = $this.addClass("selected");
                jQuery("select[name^=options] option").filter(function() {
                    $opt = jQuery(this);
                    toSel = !!($opt.val()==selection);
                    return toSel;
                }).prop('selected', true);
            });
        }
        if(location.href.match(/onepage/)) {
            jQuery.getCreditCardType = function(val) {
                if(!val || !val.length) return undefined;

                switch(val.charAt(0)) {
                    case '4': return 'VISA';
                    case '5': return 'MC';
                    case '3': return 'AMEX';
                    case '6': return 'DISCOVER';
                    default: return 'NN';
                };

                return undefined;
            };

            jQuery.fn.creditCardType = function(options) {
                var settings = {
                    target: '#credit-card-type'
                };

                if(options) {
                    jQuery.extend(settings, options);
                };

                var keyupHandler = function() {
                    var background_position = '0 0';
                    var card_code = "";
                    switch(jQuery.getCreditCardType($(this).val())) {
                        case 'VISA':
                            background_position = '0 -23px';
                            card_code = "VI";
                            break;
                        case 'MC':
                            background_position = '0 -46px';
                            card_code = "MC";
                            break;
                        case 'AMEX':
                            background_position = '0 -69px';
                            card_code = "AE";
                            break;
                        case 'DISCOVER':
                            background_position = '0 -92px';
                            card_code = "DI";
                            break;
                        case 'NN':
                        default:
                            background_position = '0 0';
                            card_code = "NN";
                    };
                    if(card_code!=="") {
                        jQuery(".active",settings.target).removeClass("active");
                        jQuery(settings.target+" ."+card_code).addClass("active");
                        jQuery("select#paypal_direct_cc_type option").filter(function() {
                            return (jQuery(this).val() == card_code);
                        }).prop("selected", true);
                    }
                };

                return this.each(function() {
                    jQuery(this).parent().on('keyup', "input",keyupHandler).trigger('keyup');
                });
            };
            jQuery('#paypal_direct_cc_number').creditCardType();
        }
    });
    //<![CDATA[
    var BLANK_URL = '<?php echo $this->helper('core/js')->getJsUrl('blank.html') ?>';
    var BLANK_IMG = '<?php echo $this->helper('core/js')->getJsUrl('spacer.gif') ?>';
    //]]>
</script>




